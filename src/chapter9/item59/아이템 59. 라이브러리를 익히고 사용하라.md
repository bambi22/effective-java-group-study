# 💡 라이브러리를 익히고 사용하라

### random 메서드의 결함
값의 범위는 0부터 무작위 정수 하나를 생성하는 코드
```java
// 흔하지만 문제가 심각한 코드
static Random rnd = new Random();

static int random(int n){
    return Math.abs(rnd.nextInt()) % n;
}
```

1. n이 크지 않은 2의 제곱수이면 같은 수열이 반복되는 문제가 있다.
2. n이 2의 제곱수가 아니면 몇몇 숫자가 평균적으로 더 자주 반환된다. n이 클수록 현상은 두드러진다.
   - 숫자의 범위가 편향되기 쉽다.
3. 지정한 범위와 다른 수가 튀어나올 수 있다.
   - nexInt()가 Integer.MIN_VALUE를 반환할 때 양수로 표현할 수 없는 가장 작은 정수 값이기 때문에 -2147483648가 출력된다.   
   - 이 문제를 해결하려면 의사난수 생성기, 정수론, 2의 보수 계산 등에 조예가 깊어야 한다.
> 결함을 직접 해결할 필요는 없다. `Random.nextInt(int)`가 이미 해결해놨다.

### 표준라이브러리 사용의 장점
1. 표준 라이브러리를 사용하면 그 코드를 작성한 전문가의 지식과 앞서 사용한 프로그래머들의 경험을 활용할 수 있다.
- 자바 7부터는 `Random`을 더 이상 사용하지 않는 게 좋다. `ThreadLocalRandom`으로 대체하면 잘 동작한다.
- `Random`보다 고품질의 무작위 수를 생성할 뿐 아니라 속도도 빠르다.
- 포크-조인 풀(Fork-Join Pool)이나 병렬 스트림에서는 `SplittableRandom`을 사용하라.
  - 포크-조인 풀은 병렬 프로그래밍에서 사용되는 스레드 풀의 한 종류로 대규모 작업을 작은 작업 단위로 분할하여 병렬로 처리하는데 사용된다.
2. 핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 된다.
3. 따로 노력하지 않아도 성능이 지속해서 개선된다.
4. 기능이 점점 많아진다.
5. 작성한 코드가 많은 사람들에게 낯익은 코드가 된다. 자연스럽게 더 읽기 좋고 유지보수가 좋아진다.

__실상은 많은 프로그래머가 `직접 구현`해 쓰고 있다.__   
아마 라이브러리에 그런 기능이 있는지 모르기 때문일 것이다. 메이저 릴리스마다 주목할 만한 수많은 기능이 추가된다.

### 자바 프로그래머라면 익숙해져야 할 자바 플랫폼 라이브러리 패키지
- java.lang
- java.util
- java.io 및 하위 패키지
- 컬렉션 프레임워크
- 스트림 라이브러리 [아이템45 ~ 48]
- java.util.concurrent
  - 동시성 가능
  - 멀티스레드 프로그래밍 작업을 단순화해주는 고수준의 편의기능 제공 [아이템80 ~ 81]
  - 능숙한 개발자가 자신만의 고수준 개념을 직접 구현할 수 있도록 도와주는 저수준 요소들을 제공

### 💡마무리
> 일반적으로 라이브러리의 코드는 품질이 좋고 점차 개선될 가능성이 크다. 코드 품질에도 규모의 경제가 적용된다.   
> 누군가 이미 라이브러리 형태로 구현해놓았을 가능성이 크다. 일단 찾아보자.
> 자바 표준 라이브러리에서 원하는 기능을 찾지 못하면 다음 선택지는 고품질 서드파티 라이브러리가 될 것이다.   
> 대표적인 예로 구글의 구아바 라이브러리가 있다. 서드파티도 찾지 못하면 그때 직접 구현하자.
